---
title: "Multivariate Data Analysis"
author: "Juan Pablo Zaldivar && Enric Millan && Joel Sole"
date: "2023-05-11"
output: html_document
---

```{r setup, include=F, warnings=F, echo=F}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo=FALSE)
library(plotly)
```

# Exploratory data analysis

```{r}
glass <- read.csv2("glass.csv", header=TRUE, sep=",")
head(glass)
```

```{r}
# Transform features into numeric
features <- names(glass)[names(glass) != "Type"]
glass[features] <- lapply(glass[features], as.numeric)

# Transform label as categorical
glass$Type <- as.factor(glass$Type)
```

```{r}
unique(glass$Type)
```


```{r}
bar_plot <- plot_ly(data = glass, x = ~Type,
                    color = ~Type, colors = "YlGnBu") %>%
  add_histogram() %>%
  layout(title = "Count of Types in Glass Dataset",
         xaxis = list(title = "Type"), yaxis = list(title = "Count"))

# Display the bar plot
bar_plot
```

```{r}
# Compute correlation matrix
corr_matrix <- cor(glass[, 1:9])

# Create a heatmap using Plotly
heatmap <- plot_ly(
  x = colnames(corr_matrix),
  y = colnames(corr_matrix),
  z = corr_matrix,
  type = "heatmap",
  colorscale = "YlGnBu"
)

# Add cell values to the heatmap
heatmap <- heatmap %>%
  add_annotations(
    x = rep(colnames(corr_matrix), each = length(colnames(corr_matrix))),
    y = rep(colnames(corr_matrix), length(colnames(corr_matrix))),
    text = round(corr_matrix, 2),
    showarrow = FALSE)

# Display the heatmap
heatmap
```













.
